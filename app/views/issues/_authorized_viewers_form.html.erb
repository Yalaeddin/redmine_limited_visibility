<script>
  $(function() {
    $('#issue-form').submit(function(e) {
      e.preventDefault();
      var form = this;
      if ($('#issue-form .role.involved').length === 0) {
        alert('<%= l('alert_cant_remove_all_visibility_roles') %>');
        return false;
      }else{
        form.submit(); // submit bypassing the jQuery bound event
      }
    });
  })
</script>

<%= render "roles/select_involved_roles", viewers: (role_ids_for_current_viewers(@issue).join('|') + '|'), current_user_visibility_roles: visibility_roles_for_current_user(@issue.project) %>
